# General Spring configuration; enable graceful shutdown with a timeout per phase
server.shutdown=graceful

# Jackson 2 compatibility mode for Spring Boot 4.0
# See: https://docs.spring.io/spring-boot/4.0-SNAPSHOT/reference/features/json.html#features.json.jackson2
spring.http.converters.preferred-json-mapper=jackson2
spring.lifecycle.timeout-per-shutdown-phase=30s
logging.register-shutdown-hook=true
# The application name is the default name used by various services like OpenTelemetry
spring.application.name=camunda
spring.application.version=@project.version@
# REST server configuration
# This sever is enabled even for a standalone broker without any embedded gateway, in which case
# there will simply be no endpoints available.
server.address=0.0.0.0
server.port=8080
# Enable a richer error model for the REST server
spring.mvc.problemdetails.enabled=true
# by default disable thymeleaf to check any location which will be overriden by the webapps
spring.thymeleaf.check-template-location=false
# Embedded HTTP server configuration for monitoring
# Defaults are picked from the previous Zeebe specific defaults for backwards compatibility
management.server.port=9600
management.server.address=0.0.0.0
# Explicitly disable SSL on the management server to prevent any REST API server
# SSL configuration from being implicitly applied to it
management.server.ssl.enabled=false
# Web/Servlet configuration
# Disable the default resource mappings (e.g. service static assets)
spring.web.resources.add-mappings=false
# General management configuration; disable all endpoints by default but exposes all enabled ones
# via web. Endpoints should be enabled individually based on the target application
management.endpoints.access.default=none
management.endpoints.web.exposure.include=*
# Health configuration; disable default health indicators. As it's unclear how to do this globally,
# only the ones which currently would get enabled are explicitly disabled.
management.endpoint.health.access=unrestricted
management.endpoint.health.show-details=always
management.health.defaults.enabled=false
# Configure Prometheus as the default enabled backend, for scraping
management.endpoint.prometheus.access=unrestricted
management.prometheus.metrics.export.enabled=true
# Disable the OpenTelemetry backend by default; can be enabled on demand by users
management.otlp.metrics.export.enabled=false
# Allow runtime configuration of log levels
management.endpoint.loggers.access=unrestricted
# Allow viewing the config properties, but sanitize their outputs
management.endpoint.configprops.access=unrestricted
management.endpoint.configprops.show-values=always
management.endpoint.info.access=unrestricted
# since springboot 3.4, we need to explicitly enable the custom actuator endpoints, as they are globally disabled by default
management.endpoint.backupHistory.access=unrestricted
management.endpoint.backupRuntime.access=unrestricted
management.endpoint.backups.access=unrestricted
management.endpoint.banning.access=unrestricted
management.endpoint.clock.access=unrestricted
management.endpoint.cluster.access=unrestricted
management.endpoint.exporters.access=unrestricted
management.endpoint.exporting.access=unrestricted
management.endpoint.flowControl.access=unrestricted
management.endpoint.jobstreams.access=unrestricted
management.endpoint.partitions.access=unrestricted
management.endpoint.rebalance.access=unrestricted
management.endpoint.usage-metrics.access=unrestricted
# Define keywords to sanitize in applicable endpoints; this will be applied to the configprops,
# beans, and if enabled, the environment endpoint as well
management.sanitize.keywords=user,pass,secret,accessKey,accountKey,token,\
  connectionString
# Multipart file uploads
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
server.tomcat.max-part-count=50

#
# RDBMS extension default properties
#
spring.jpa.generate-ddl=false
spring.jpa.hibernate.ddl-auto=validate
spring.liquibase.enabled=false
# forward spring datasource properties
spring.datasource.url=${camunda.data.secondary-storage.rdbms.url:}
spring.datasource.username=${camunda.data.secondary-storage.rdbms.username:}
spring.datasource.password=${camunda.data.secondary-storage.rdbms.password:}
spring.datasource.hikari.maximum-pool-size=${camunda.data.secondary-storage.rdbms.connection-pool.maximum-pool-size:10}
spring.datasource.hikari.minimum-idle=${camunda.data.secondary-storage.rdbms.connection-pool.minimum-idle:2}
spring.datasource.hikari.idle-timeout=${camunda.data.secondary-storage.rdbms.connection-pool.idle-timeout:600000}
spring.datasource.hikari.max-lifetime=${camunda.data.secondary-storage.rdbms.connection-pool.max-lifetime:1800000}
spring.datasource.hikari.connection-timeout=${camunda.data.secondary-storage.rdbms.connection-pool.connection-timeout:30000}
mybatis.mapper-locations=classpath:mapper/**/*-mapper.xml

# Disable specific autoconfiguration classes which are triggered automatically (e.g. creating an
# Elastic client which spawns 16 threads)
spring.autoconfigure.exclude=\
  org.springframework.boot.security.autoconfigure.web.servlet.ServletWebSecurityAutoConfiguration, \
  org.springframework.boot.security.autoconfigure.actuate.web.servlet.ManagementWebSecurityAutoConfiguration, \
  org.springframework.boot.jdbc.autoconfigure.DataSourceAutoConfiguration, \
  org.springframework.boot.jdbc.autoconfigure.DataSourceTransactionManagerAutoConfiguration

# Spring metrics configuration
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles.http.server.requests=0.5,0.95,0.99

springdoc.swagger-ui.csrf.enabled=true
springdoc.swagger-ui.csrf.header-name=X-CSRF-TOKEN
springdoc.swagger-ui.csrf.session-storage-key=X-CSRF-TOKEN
springdoc.swagger-ui.csrf.use-session-storage=false
springdoc.swagger-ui.csrf.use-local-storage=true

camunda.security.multiTenancy.checksEnabled=${zeebe.broker.gateway.multiTenancy.enabled:false}

# Spring AI MCP integration - disabled by default
spring.ai.mcp.server.enabled=false
spring.ai.mcp.server.annotation-scanner.enabled=false
