# Authorization domain schemas
AuthorizationRequest:
  type: object
  additionalProperties: false
  properties:
    ownerId:
      description: The ID of the owner of the permissions.
      type: string
    ownerType:
      $ref: '../common/enums.yaml#/OwnerTypeEnum'
    resourceId:
      description: The ID of the resource to add permissions to.
      type: string
    resourceType:
      $ref: '../common/enums.yaml#/ResourceTypeEnum'
    permissionTypes:
      type: array
      items:
        $ref: '../common/enums.yaml#/PermissionTypeEnum'
  required:
    - ownerId
    - ownerType
    - resourceId
    - resourceType
    - permissionTypes

AuthorizationCreateResult:
  type: object
  properties:
    authorizationKey:
      allOf:
        - $ref: '../common/keys.yaml#/AuthorizationKey'
      description: The key of the created authorization.

AuthorizationSearchQuerySortRequest:
  type: object
  properties:
    field:
      description: The field to sort by.
      type: string
      enum:
        - ownerId
        - ownerType
        - resourceId
        - resourceType
    order:
      $ref: '../common/enums.yaml#/SortOrderEnum'
  required:
    - field

AuthorizationSearchQuery:
  type: object
  additionalProperties: false
  allOf:
    - $ref: '../search/search-models.yaml#/SearchQueryRequest'
  properties:
    sort:
      description: Sort field criteria.
      type: array
      items:
        $ref: '#/AuthorizationSearchQuerySortRequest'
    filter:
      $ref: '#/AuthorizationFilter'
      description: The authorization search filters.

AuthorizationFilter:
  description: Authorization search filter.
  type: object
  properties:
    ownerId:
      description: The ID of the owner of permissions.
      type: string
    ownerType:
      $ref: '../common/enums.yaml#/OwnerTypeEnum'
    resourceIds:
      description: The IDs of the resource to search permissions for.
      type: array
      items:
        type: string
    resourceType:
      $ref: '../common/enums.yaml#/ResourceTypeEnum'

AuthorizationResult:
  type: object
  properties:
    ownerId:
      description: The ID of the owner of permissions.
      type: string
    ownerType:
      $ref: '../common/enums.yaml#/OwnerTypeEnum'
    resourceType:
      $ref: '../common/enums.yaml#/ResourceTypeEnum'
    resourceId:
      description: ID of the resource the permission relates to.
      type: string
    permissionTypes:
      description: Specifies the types of the permissions.
      type: array
      items:
        $ref: '../common/enums.yaml#/PermissionTypeEnum'
    authorizationKey:
      allOf:
        - $ref: '../common/keys.yaml#/AuthorizationKey'
      description: The key of the authorization.

AuthorizationSearchResult:
  type: object
  allOf:
    - $ref: '../search/search-models.yaml#/SearchQueryResponse'
  properties:
    items:
      description: The matching authorizations.
      type: array
      items:
        $ref: '#/AuthorizationResult'
