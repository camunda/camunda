# User task domain schemas
UserTaskSearchQuerySortRequest:
  type: object
  properties:
    field:
      description: The field to sort by.
      type: string
      enum:
        - creationDate
        - completionDate
        - followUpDate
        - dueDate
        - priority
        - name
    order:
      $ref: '../common/enums.yaml#/SortOrderEnum'
  required:
    - field

UserTaskSearchQuery:
  description: User task search query request.
  additionalProperties: false
  type: object
  allOf:
    - $ref: '../search/search-models.yaml#/SearchQueryRequest'
  properties:
    sort:
      description: Sort field criteria.
      type: array
      items:
        $ref: '#/UserTaskSearchQuerySortRequest'
    filter:
      $ref: '#/UserTaskFilter'
      description: The user task search filters.

UserTaskFilter:
  description: User task filter request.
  type: object
  properties:
    state:
      $ref: '#/UserTaskStateFilterProperty'
      description: The user task state.
    assignee:
      $ref: '../common/filters.yaml#/StringFilterProperty'
      description: The assignee of the user task.
    priority:
      $ref: '../common/filters.yaml#/IntegerFilterProperty'
      description: The priority of the user task.
    elementId:
      $ref: '../common/identifiers.yaml#/ElementId'
      description: The element ID of the user task.
    name:
      type: string
      description: >
        The task name. This only works for data created with 8.8 and onwards.
        Instances from prior versions don't contain this data and cannot be found.
    candidateGroup:
      $ref: '../common/filters.yaml#/StringFilterProperty'
      description: The candidate group for this user task.
    candidateUser:
      $ref: '../common/filters.yaml#/StringFilterProperty'
      description: The candidate user for this user task.
    tenantId:
      allOf:
        - $ref: '../common/filters.yaml#/StringFilterProperty'
      description: Tenant ID of this user task.
    processDefinitionId:
      allOf:
        - $ref: '../common/identifiers.yaml#/ProcessDefinitionId'
      description: The ID of the process definition.
    creationDate:
      $ref: '../common/filters.yaml#/DateTimeFilterProperty'
      description: The user task creation date.
    completionDate:
      $ref: '../common/filters.yaml#/DateTimeFilterProperty'
      description: The user task completion date.
    followUpDate:
      $ref: '../common/filters.yaml#/DateTimeFilterProperty'
      description: The user task follow-up date.
    dueDate:
      $ref: '../common/filters.yaml#/DateTimeFilterProperty'
      description: The user task due date.
    processInstanceVariables:
      type: array
      items:
        $ref: '../variables/variable-models.yaml#/VariableValueFilterProperty'
    localVariables:
      type: array
      items:
        $ref: '../variables/variable-models.yaml#/VariableValueFilterProperty'
    userTaskKey:
      allOf:
        - $ref: '../common/keys.yaml#/UserTaskKey'
      description: The key for this user task.
    processDefinitionKey:
      allOf:
        - $ref: '../common/keys.yaml#/ProcessDefinitionKey'
      description: The key of the process definition.
    processInstanceKey:
      allOf:
        - $ref: '../common/keys.yaml#/ProcessInstanceKey'
      description: The key of the process instance.
    elementInstanceKey:
      allOf:
        - $ref: '../common/keys.yaml#/ElementInstanceKey'
      description: The key of the element instance.

UserTaskSearchQueryResult:
  description: User task search query response.
  type: object
  allOf:
    - $ref: '../search/search-models.yaml#/SearchQueryResponse'
  properties:
    items:
      description: The matching user tasks.
      type: array
      items:
        $ref: '#/UserTaskResult'

UserTaskResult:
  type: object
  properties:
    name:
      type: string
      description: The name for this user task.
    state:
      $ref: '../common/enums.yaml#/UserTaskStateEnum'
    assignee:
      description: The assignee of the user task.
      type: string
    elementId:
      description: The element ID of the user task.
      allOf:
        - $ref: '../common/identifiers.yaml#/ElementId'
    candidateGroups:
      type: array
      description: The candidate groups for this user task.
      items:
        type: string
    candidateUsers:
      type: array
      description: The candidate users for this user task.
      items:
        type: string
    processDefinitionId:
      allOf:
        - $ref: '../common/identifiers.yaml#/ProcessDefinitionId'
      description: The ID of the process definition.
    creationDate:
      type: string
      description: The creation date of a user task.
      format: date-time
    completionDate:
      type: string
      description: The completion date of a user task.
      format: date-time
    followUpDate:
      type: string
      description: The follow date of a user task.
      format: date-time
    dueDate:
      type: string
      description: The due date of a user task.
      format: date-time
    tenantId:
      $ref: '../common/identifiers.yaml#/TenantId'
    externalFormReference:
      type: string
      description: The external form reference.
    processDefinitionVersion:
      type: integer
      description: The version of the process definition.
      format: int32
    customHeaders:
      type: object
      description: Custom headers for the user task.
      additionalProperties:
        type: string
    priority:
      type: integer
      description: The priority of a user task. The higher the value the higher the priority.
      minimum: 0
      maximum: 100
      default: 50
    userTaskKey:
      allOf:
        - $ref: '../common/keys.yaml#/UserTaskKey'
      description: The key of the user task.
    elementInstanceKey:
      allOf:
        - $ref: '../common/keys.yaml#/ElementInstanceKey'
      description: The key of the element instance.
    processName:
      type: string
      description: The name of the process definition.
    processDefinitionKey:
      allOf:
        - $ref: '../common/keys.yaml#/ProcessDefinitionKey'
      description: The key of the process definition.
    processInstanceKey:
      allOf:
        - $ref: '../common/keys.yaml#/ProcessInstanceKey'
      description: The key of the process instance.
    formKey:
      allOf:
        - $ref: '../common/keys.yaml#/FormKey'
      description: The key of the form.

UserTaskCompletionRequest:
  type: object
  additionalProperties: false
  properties:
    variables:
      additionalProperties: true
      description: The variables to complete the user task with.
      type: object
      nullable: true
    action:
      description: >
        A custom action value that will be accessible from user task events resulting
        from this endpoint invocation. If not provided, it will default to "complete".
      type: string
      nullable: true

UserTaskAssignmentRequest:
  type: object
  additionalProperties: false
  properties:
    assignee:
      description: The assignee for the user task. The assignee must not be empty or `null`.
      type: string
      nullable: false
    allowOverride:
      description: >
        By default, the task is reassigned if it was already assigned. Set this to `false`
        to return an error in such cases. The task must then first be unassigned to
        be assigned again. Use this when you have users picking from group task
        queues to prevent race conditions.
      type: boolean
      nullable: true
    action:
      description: >
        A custom action value that will be accessible from user task events resulting
        from this endpoint invocation. If not provided, it will default to "assign".
      type: string
      nullable: true

UserTaskUpdateRequest:
  type: object
  additionalProperties: false
  properties:
    changeset:
      $ref: '#/Changeset'
    action:
      description: The action performed.
      type: string
      nullable: true

Changeset:
  description: |
    JSON object with changed task attribute values.

    The following attributes can be adjusted with this endpoint, additional attributes
    will be ignored:

    * `candidateGroups` - reset by providing an empty list
    * `candidateUsers` - reset by providing an empty list
    * `dueDate` - reset by providing an empty String
    * `followUpDate` - reset by providing an empty String
    * `priority` - minimum 0, maximum 100, default 50

    Providing any of those attributes with a `null` value or omitting it preserves
    the persisted attribute's value.

    The assignee cannot be adjusted with this endpoint, use the Assign task endpoint.
    This ensures correct event emission for assignee changes.
  type: object
  nullable: true
  additionalProperties: true
  properties:
    dueDate:
      type: string
      format: date-time
      description: The due date of the task. Reset by providing an empty String.
      nullable: true
    followUpDate:
      type: string
      format: date-time
      description: The follow-up date of the task. Reset by providing an empty String.
      nullable: true
    candidateUsers:
      type: array
      description: The list of candidate users of the task. Reset by providing an empty list.
      items:
        type: string
      nullable: true
    candidateGroups:
      type: array
      description: The list of candidate groups of the task. Reset by providing an empty list.
      items:
        type: string
      nullable: true
    priority:
      type: integer
      format: int32
      description: The priority of the task.
      minimum: 0
      default: 50
      maximum: 100
      nullable: true

UserTaskVariableSearchQuerySortRequest:
  type: object
  properties:
    field:
      description: The field to sort by.
      type: string
      enum:
        - value
        - name
        - tenantId
        - variableKey
        - scopeKey
        - processInstanceKey
    order:
      $ref: '../common/enums.yaml#/SortOrderEnum'
  required:
    - field

UserTaskVariableSearchQueryRequest:
  allOf:
    - $ref: '../search/search-models.yaml#/SearchQueryRequest'
  description: User task search query request.
  additionalProperties: false
  type: object
  properties:
    sort:
      description: Sort field criteria.
      type: array
      items:
        $ref: '#/UserTaskVariableSearchQuerySortRequest'
    filter:
      $ref: '#/UserTaskVariableFilter'
      description: The user task variable search filters.

UserTaskVariableFilter:
  description: The user task variable search filters.
  type: object
  properties:
    name:
      $ref: '../common/filters.yaml#/StringFilterProperty'
      description: Name of the variable.

UserTaskProperties:
  type: object
  description: Contains properties of a user task.
  properties:
    action:
      description: The action performed on the user task.
      type: string
    assignee:
      description: The user assigned to the task.
      type: string
      nullable: true
    candidateGroups:
      type: array
      items:
        type: string
    candidateUsers:
      type: array
      items:
        type: string
    changedAttributes:
      type: array
      items:
        type: string
    dueDate:
      description: The due date of the user task in ISO 8601 format.
      type: string
      nullable: true
    followUpDate:
      description: The follow-up date of the user task in ISO 8601 format.
      type: string
      nullable: true
    formKey:
      allOf:
        - $ref: '../common/keys.yaml#/FormKey'
      description: The key of the form associated with the user task.
    priority:
      description: The priority of the user task.
      type: integer
      format: int32
      minimum: 0
      maximum: 100
      nullable: true
    userTaskKey:
      allOf:
        - $ref: '../common/keys.yaml#/UserTaskKey'
      nullable: true

UserTaskStateFilterProperty:
  description: UserTaskStateEnum property with full advanced search capabilities.
  type: object
  oneOf:
    - type: string
      title: Exact match
      description: Matches the value exactly.
      allOf:
        - $ref: "../common/enums.yaml#/UserTaskStateEnum"
    - $ref: "#/AdvancedUserTaskStateFilter"

AdvancedUserTaskStateFilter:
  title: Advanced filter
  description: Advanced UserTaskStateEnum filter.
  type: object
  properties:
    $eq:
      description: Checks for equality with the provided value.
      allOf:
        - $ref: "../common/enums.yaml#/UserTaskStateEnum"
    $neq:
      description: Checks for inequality with the provided value.
      allOf:
        - $ref: "../common/enums.yaml#/UserTaskStateEnum"
    $exists:
      description: Checks if the current property exists.
      type: boolean
    $in:
      description: Checks if the property matches any of the provided values.
      type: array
      items:
        $ref: "../common/enums.yaml#/UserTaskStateEnum"
    $like:
      $ref: "../common/filters.yaml#/LikeFilter"
