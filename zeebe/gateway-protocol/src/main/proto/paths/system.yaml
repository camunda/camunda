# System endpoints
/system/usage-metrics:
  get:
    tags:
      - System
    operationId: getUsageMetrics
    summary: Get usage metrics
    description: Retrieve the usage metrics based on given criteria.
    parameters:
      - name: startTime
        in: query
        required: true
        description: The start date for usage metrics, including this date. Value in ISO 8601 format.
        schema:
          type: string
          format: date-time
          example: "2025-06-07T13:14:15Z"
      - name: endTime
        in: query
        required: true
        description: The end date for usage metrics, including this date. Value in ISO 8601 format.
        schema:
          type: string
          format: date-time
          example: "2025-06-07T13:14:15Z"
      - name: tenantId
        in: query
        required: false
        description: Restrict results to a specific tenant ID. If not provided, results for all tenants are returned.
        schema:
          $ref: '../schemas/common/identifiers.yaml#/TenantId'
      - name: withTenants
        in: query
        required: false
        description: Whether to return tenant metrics in addition to the total metrics or not. Default false.
        schema:
          type: boolean
          default: false
    responses:
      "200":
        description: The usage metrics search result.
        content:
          application/json:
            schema:
              $ref: '../schemas/system/system-models.yaml#/UsageMetricsResponse'
            examples:
              Response without tenants:
                value:
                  processInstances: 5
                  decisionInstances: 23
                  activeTenants: 2
                  assignees: 3
                  tenants: {}
              Response with tenants:
                value:
                  processInstances: 5
                  decisionInstances: 23
                  activeTenants: 2
                  assignees: 3
                  tenants:
                    tenant1:
                      processInstances: 1
                      decisionInstances: 2
                      assignees: 1
                    tenant2:
                      processInstances: 4
                      decisionInstances: 21
                      assignees: 3
      "400":
        $ref: '../responses/common-responses.yaml#/InvalidData'
      "401":
        $ref: '../responses/common-responses.yaml#/Unauthorized'
      "403":
        $ref: '../responses/common-responses.yaml#/Forbidden'
      "500":
        $ref: '../responses/common-responses.yaml#/InternalServerError'
    x-eventually-consistent: true
