# Common search-related schemas

components:
  schemas:
    SearchQueryRequest:
      type: object
      properties:
        page:
          description: Pagination criteria.
          allOf:
            - $ref: '#/components/schemas/SearchQueryPageRequest'

    SearchQueryPageRequest:
      x-polymorphic-schema: true
      description: Pagination criteria. Can use offset-based pagination (from/limit) OR cursor-based pagination (after/before + limit), but not both.
      oneOf:
        - $ref: '#/components/schemas/LimitPagination'
        - $ref: '#/components/schemas/OffsetPagination'
        - $ref: '#/components/schemas/CursorForwardPagination'
        - $ref: '#/components/schemas/CursorBackwardPagination'

    LimitPagination:
      type: object
      title: Limit-based pagination
      properties:
        limit:
          description: The maximum number of items to return in one request.
          type: integer
          format: int32
          default: 100
          minimum: 1
          maximum: 10000

    OffsetPagination:
      type: object
      title: Offset-based pagination
      properties:
        from:
          description: The index of items to start searching from.
          type: integer
          format: int32
          minimum: 0
        limit:
          description: The maximum number of items to return in one request.
          type: integer
          format: int32
          default: 100
          minimum: 1

    CursorForwardPagination:
      type: object
      title: Cursor-based forward pagination
      required:
        - after
      properties:
        after:
          description: Use the `endCursor` value from the previous response to fetch the next page of results.
          allOf:
            - $ref: 'cursors.yaml#/components/schemas/EndCursor'
        limit:
          description: The maximum number of items to return in one request.
          type: integer
          format: int32
          default: 100
          minimum: 1
          maximum: 10000

    CursorBackwardPagination:
      type: object
      title: Cursor-based backward pagination
      required:
        - before
      properties:
        before:
          description: Use the `startCursor` value from the previous response to fetch the previous page of results.
          allOf:
            - $ref: 'cursors.yaml#/components/schemas/StartCursor'
        limit:
          description: The maximum number of items to return in one request.
          type: integer
          format: int32
          default: 100
          minimum: 1
          maximum: 10000

    SearchQueryResponse:
      type: object
      required:
        - page
      properties:
        page:
          $ref: '#/components/schemas/SearchQueryPageResponse'

    SortOrderEnum:
      description: The order in which to sort the related field.
      type: string
      enum:
        - ASC
        - DESC
      default: ASC

    SearchQueryPageResponse:
      description: Pagination information about the search results.
      type: object
      required:
        - totalItems
      x-semantic-provider:
        - startCursor
        - endCursor
      properties:
        totalItems:
          description: Total items matching the criteria.
          type: integer
          format: int64
        hasMoreTotalItems:
          description: |
            Indicates whether there are more items matching the criteria beyond the returned items.
            This is useful for determining if additional requests are needed to retrieve all results.
          type: boolean
        startCursor:
          description: The cursor value for getting the previous page of results. Use this in the `before` field of an ensuing request.
          allOf:
            - $ref: 'cursors.yaml#/components/schemas/StartCursor'
        endCursor:
          description: The cursor value for getting the next page of results. Use this in the `after` field of an ensuing request.
          allOf:
            - $ref: 'cursors.yaml#/components/schemas/EndCursor'
      example:
        totalItems: 1
        hasMoreTotalItems: false
