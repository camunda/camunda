## Endpoint definitions

paths:
  /conditions:
    post:
      x-eventually-consistent: false
      tags:
        - Condition
      operationId: triggerConditionalStartEvent
      summary: Trigger a root level conditional start events
      description: Used to trigger root level conditional start events for process definitions.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConditionalStartEventTriggerInstruction'
        responses:
          "200":
            description: Successfully triggered conditional start events.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/TriggerConditionalEventResult'
        "400":
          $ref: 'common-responses.yaml#/components/responses/InvalidData'
        "403":
          $ref: 'common-responses.yaml#/components/responses/Forbidden'

components:
  schemas:
    ConditionalStartEventTriggerInstruction:
      type: object
      required:
        - variables
      properties:
        tenantId:
          allOf:
            - $ref: 'identifiers.yaml#/components/schemas/TenantId'
          required: false
          description: Used to evaluate a condition for a tenant with the given id. Will only evaluate conditions of process definitions which belong to the tenant.
        processDefinitionKey:
          allOf:
            - $ref: 'keys.yaml#/components/schemas/ProcessDefinitionKey'
          required: false
          description: Used to evaluate conditions of the process definition with the given key.
          example: "2251799813686749"
        variables:
          type: object
          required: true
          description: A JSON serialized document describing variables as key value pairs; the root of the document must be an object. Variables will be used for evaluation of the conditions and are injected into the process instances which have been triggered.
          additionalProperties: true
          example:
            x: 2

    TriggerConditionalEventResult:
      type: object
      properties:
        processInstances:
          type: array
          items:
            $ref: '#/components/schemas/ProcessInstanceReference'
          description: List of process instances that were triggered.

    ProcessInstanceReference:
      type: object
      properties:
        processDefinitionKey:
          allOf:
            - $ref: 'keys.yaml#/components/schemas/ProcessDefinitionKey'
          description: The key of the process definition.
        processInstanceKey:
          allOf:
            - $ref: 'keys.yaml#/components/schemas/ProcessInstanceKey'
          description: The key of the created process instance.
